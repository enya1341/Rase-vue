{"remainingRequest":"C:\\Users\\ぱすー\\Desktop\\rase-vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\ぱすー\\Desktop\\rase-vue\\src\\views\\StoreAdmin.vue?vue&type=style&index=0&id=4a1189a8&scoped=true&lang=css&","dependencies":[{"path":"C:\\Users\\ぱすー\\Desktop\\rase-vue\\src\\views\\StoreAdmin.vue","mtime":1626565338156},{"path":"C:\\Users\\ぱすー\\Desktop\\rase-vue\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\ぱすー\\Desktop\\rase-vue\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\Users\\ぱすー\\Desktop\\rase-vue\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"C:\\Users\\ぱすー\\Desktop\\rase-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\ぱすー\\Desktop\\rase-vue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKDQoNCg0KDQoNCiNTdG9yZUFkbWluew0KICBiYWNrZ3JvdW5kLWNvbG9yOnJnYigyMDYsIDIwNiwgMjA2KTsNCiAgd2lkdGg6MTAwJTsNCn0NCg0KLmZsZXggew0KICBkaXNwbGF5OiBmbGV4Ow0KICBmbGV4LXdyYXAgOndyYXA7DQp9DQoNCi5oZWFkZXItaWNvbiBwew0KICBtYXJnaW4tdG9wOjU1cHg7DQogIG1hcmdpbi1sZWZ0OjYwcHg7DQogIGZvbnQtc2l6ZToxOHB4Ow0KICBjdXJzb3I6IHBvaW50ZXI7DQogIGNvbG9yOnllbGxvdzsNCn0NCg0KLmxlZnQtc3RvcmVkYXRhew0KICBkaXNwbGF5OiB0YWJsZTsNCiAgd2lkdGg6MzUlOw0KICBtYXJnaW46ODBweCBhdXRvOw0KfQ0KDQouc3RvcmUtdG9wew0KICBwYWRkaW5nLWJvdHRvbToxNXB4Ow0KICBjb2xvcjpibGFjazsNCiAgYm9yZGVyLWJvdHRvbToycHggc29saWQgYmxhY2s7DQp9DQoNCi5zdG9yZWRhdGF7DQogIG1hcmdpbjo0MHB4IDE1cHg7DQp9DQoNCi5kYXRhew0KICBwYWRkaW5nLWJvdHRvbToxNXB4Ow0KfQ0KDQouZGF0YSB0aHsNCiAgY29sb3I6YmxhY2s7DQogIHdpZHRoOjExMHB4Ow0KICB0ZXh0LWFsaWduOiBsZWZ0Ow0KICB2ZXJ0aWNhbC1hbGlnbjp0b3A7DQp9DQoNCg0KLmRhdGEgbGFiZWx7DQogIGNvbG9yOmJsYWNrOw0KICBmb250LXNpemU6MTZweDsNCn0NCg0KLnN0b3JlZGF0YXN7DQogIHBhZGRpbmctbGVmdDoyMCU7DQp9DQoNCi5kYXRhIHRkew0KICBjb2xvcjpibGFjazsNCiAgd2lkdGg6NDAlOw0KICB0ZXh0LWFsaWduOiBsZWZ0Ow0KfQ0KDQouZGF0YSBmb3Jtew0KICBjb2xvcjpibGFjazsNCiAgd2lkdGg6NDAlOw0KICBtYXJnaW4tbGVmdDo2MHB4Ow0KfQ0KDQouZGF0YSBpbnB1dHsNCiAgY29sb3I6YmxhY2s7DQogIHZlcnRpY2FsLWFsaWduOnRvcDsNCn0NCg0KLmRhdGEgdGV4dGFyZWF7DQogIGNvbG9yOmJsYWNrOw0KICBwYWRkaW5nOjEwcHggMTBweDsNCiAgdmVydGljYWwtYWxpZ246dG9wOw0KfQ0KDQoucmlnaHQtcmVzZXJ2YXRpb257DQogIHdpZHRoOjQwJTsNCiAgbWFyZ2luOjgwcHggMDsNCiAgcGFkZGluZy1yaWdodDo2MHB4Ow0KfQ0KDQoucmVzZXJ2YXRpb24tdG9wew0KICBwYWRkaW5nLWJvdHRvbToxNXB4Ow0KICBjb2xvcjpibGFjazsNCiAgYm9yZGVyLWJvdHRvbToycHggc29saWQgYmxhY2s7DQp9DQoNCi5yZXNlcnZhdGlvbmRhdGF7DQogIG1hcmdpbjo0MHB4IDE1cHg7DQp9DQoNCi5yZXNlcnZhdGlvbi1zdG9yZSB7DQogIG1hcmdpbi1ib3R0b206MzBweDsNCn0NCg0KDQpidXR0b24gew0KICBkaXNwbGF5OiB0YWJsZTsNCiAgd2lkdGg6IDEwMHB4Ow0KICB0ZXh0LWFsaWduOiBjZW50ZXI7DQogIHBhZGRpbmc6IDhweCAwIDEwcHg7DQogIGNvbG9yOiAjZmZmOw0KICBiYWNrZ3JvdW5kLWNvbG9yOiAjMmYwMGZmOw0KICBib3JkZXItcmFkaXVzOiAyNXB4Ow0KICBjdXJzb3I6IHBvaW50ZXI7DQogIG1hcmdpbjo2MHB4IGF1dG8gMDsNCn0NCg0K"},{"version":3,"sources":["StoreAdmin.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6NA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"StoreAdmin.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <div id=\"StoreAdmin\" v-if=\"sync || $store.state.user.storeAdmin === 1\">\r\n\r\n    <div class=\"header-icon flex\">\r\n      <HeaderIcon/>\r\n      <p @click=\"mypage\">マイページへ</p>\r\n    </div>\r\n\r\n    <div class=\"flex\">\r\n      <div class=\"left-storedata\">\r\n        <h1 class=\"store-top\">ストアの追加と更新</h1>\r\n        <div class=\"storedata\">\r\n          <div class=\"data\">\r\n            <th>店舗名:</th>\r\n            <td v-if=\"!storeAuth\" class=\"storedatas\">{{$store.state.storedata.name}}</td>\r\n            <td>\r\n              <input type=\"text\" v-if=\"storeAuth\" v-model=\"storedata.name\" />\r\n            </td>\r\n          </div>\r\n          <div class=\"data\">\r\n            <th>地域:</th>\r\n            <td v-if=\"!storeAuth\" class=\"storedatas\">{{$store.state.storedata.region}}</td>\r\n            <td>\r\n              <input type=\"text\" v-if=\"storeAuth\" v-model=\"storedata.region\" />\r\n            </td>\r\n          </div>\r\n          <div class=\"data\">\r\n            <th>ジャンル:</th>\r\n            <td v-if=\"!storeAuth\" class=\"storedatas\">{{$store.state.storedata.genre}}</td>\r\n            <td>\r\n              <input type=\"text\" v-if=\"storeAuth\" v-model=\"storedata.genre\" />\r\n            </td>\r\n          </div>\r\n          <div class=\"data\">\r\n            <th>店舗概要:</th>\r\n            <td v-if=\"!storeAuth\" class=\"storedatas\">{{$store.state.storedata.overview}}</td>\r\n            <td>\r\n              <textarea type=\"text\" v-if=\"storeAuth\" v-model=\"storedata.overview\" />\r\n            </td>\r\n          </div>\r\n          <div class=\"data flex\" v-if=\"storeAuth\">\r\n            <th>\r\n              <label for=\"imageIn\">ファイル選択:</label>\r\n            </th>\r\n            <form>\r\n              <input type=\"file\" id=\"imageIn\" ref=\"file\" name=\"imageIn\" accept=\"image/jpeg, image/png, image/jpg\" @change=\"onChangeImage\">\r\n            </form>\r\n          </div>\r\n          <div class=\"data\">\r\n            <th>店舗画像:</th>\r\n            <td v-if=\"storedata.image\">\r\n              <img v-if=\"!storeAuth\" :src=\"Storeimage(this.$store.state.storedata.image)\" width=\"200px\">\r\n              <img v-if=\"storeAuth\" :src=\"this.imagedata.image\" width=\"200px\">\r\n            </td>\r\n          </div>\r\n          <div class=\"flex\">\r\n            <button v-if=\"!storeAuth && !this.$store.state.user.storeAdmin_id\" @click=\"storeAuthOn\">店舗情報登録</button>\r\n            <button v-if=\"!storeAuth\" @click=\"storeAuthOn\">店舗情報更新</button>\r\n            <button v-if=\"storeAuth\" @click=\"storeAuthOff\">戻る</button>\r\n            <button v-if=\"storeAuth && !this.$store.state.user.storeAdmin_id\" @click=\"storeDataAdd\">登録</button>\r\n            <button v-if=\"storeAuth && this.$store.state.user.storeAdmin_id\" @click=\"storeDataUpdate\">更新</button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      \r\n      <div class=\"right-reservation\">\r\n        <h1 class=\"reservation-top\">店舗予約情報</h1>\r\n        <div class=\"reservationdata\">\r\n          <div class=\"reservation-store\" v-for=\"(reservation,index) in reservationdata\" :key=\"index\">\r\n            <Reservation :parentReservationdata=\"reservation\" :parentReservationStoredata=\"$store.state.storedata\" :parentIndex=\"index+1\" :parentSwitch=\"true\"/>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n/** Headerの会社ロゴのコンポーネント */\r\nimport HeaderIcon from '@/components/HeaderIcon.vue'\r\n\r\n/** 予約データ画像のコンポーネント */\r\nimport Reservation from '@/components/Reservation.vue'\r\n\r\nimport axios from \"axios\";\r\n\r\nexport default {\r\n\r\n  data(){\r\n    return{\r\n      storedata:{\r\n        name:this.$store.state.storedata.name,\r\n        region:this.$store.state.storedata.region,\r\n        genre:this.$store.state.storedata.genre,\r\n        overview:this.$store.state.storedata.overview,\r\n        image:this.$store.state.storedata.image\r\n      },\r\n      store:\"\",\r\n      storeAuth:false,\r\n      reservationdata:\"\",\r\n      sync:false,\r\n      image:\"\",\r\n      imagedata:{\r\n        image:\"\",\r\n        name:\"\",\r\n      }\r\n\r\n    }\r\n  },\r\n\r\n  components: {\r\n    HeaderIcon,\r\n    Reservation\r\n  },\r\n\r\n  methods: {\r\n\r\n    /** マイページに戻る */\r\n    mypage() {\r\n      this.$router.push(\"/mypage\");\r\n    },\r\n\r\n    /** 店舗登録か更新をする際の画面切り替え用 開く*/\r\n    storeAuthOn() {\r\n      this.storeAuth=true;\r\n    },\r\n\r\n    /** 店舗登録か更新をする際の画面切り替え用 閉じる*/\r\n    storeAuthOff() {\r\n      this.storeAuth=false;\r\n    },\r\n\r\n    /** DBから取ってきたパスから画像呼び出せるように溶接する関数。S3から取得*/\r\n    Storeimage(imgURL){\r\n      return `https://rase-enya.s3.ap-northeast-1.amazonaws.com/${imgURL}`\r\n    },\r\n\r\n    /**画像データが入った際に画像データを入れる*/\r\n    onChangeImage: function(event) {\r\n      const files = this.$refs.file;\r\n      const fileImg = files.files[0];\r\n      this.storedata.image = event.target.files[0];\r\n      if (fileImg.type.startsWith(\"image/\")) {\r\n        this.imagedata.image = window.URL.createObjectURL(fileImg);\r\n        this.imagedata.name = fileImg.name;\r\n        this.imagedata.type = fileImg.type;\r\n      }\r\n    },\r\n\r\n    /**ストアを作成する*/\r\n    async storeDataAdd(){\r\n\r\n      // 画像を送れるように型を作る\r\n      const imagedata = new FormData();\r\n      imagedata.append(\"image\", this.storedata.image);\r\n      const config = {headers: {'content-type': 'multipart/form-data'}}\r\n\r\n      // ストアデータの送信。ユーザーデータにストアIDを送る Post\r\n      await axios.post(this.$store.state.host + \"/api/v1/storeAdmin/stores\",{\r\n        name: this.storedata.name,\r\n        region: this.storedata.region,\r\n        genre: this.storedata.genre,\r\n        overview:this.storedata.overview,\r\n        email:this.$store.state.user.email\r\n      }).then((response) => {this.$store.commit('storedata',response.data.data[0]),this.$store.commit('user_store_id',response.data.storedata)});\r\n\r\n      // 画像データをS3に送信してパスをDBにいれる Post\r\n      await axios.post(this.$store.state.host + \"/api/v1/\" + this.$store.state.user.storeAdmin_store_id + \"/storeAdmin/stores/image\",imagedata,config).then((response) => {this.$store.commit('image',response.data.data)})\r\n\r\n      //データを入れられたらリロード\r\n      if(this.$store.state.user.storeAdmin_store_id){\r\n        this.storeAuth=false;\r\n        this.$router.go({path: this.$router.currentRoute.path, force: true})\r\n      }\r\n    },\r\n\r\n    /**ストアを更新する*/\r\n    async storeDataUpdate(){\r\n\r\n      // 画像を送れるように型を作る\r\n      const imagedata = new FormData();\r\n      imagedata.append(\"image\", this.storedata.image);\r\n      const config = {headers: {'content-type': 'multipart/form-data'}};\r\n\r\n      // ストアデータの更新 Put\r\n      await axios.put(this.$store.state.host + \"/api/v1/\" + this.$store.state.storedata.id + \"/storeAdmin/stores\",{\r\n        name: this.storedata.name,\r\n        region: this.storedata.region,\r\n        genre: this.storedata.genre,\r\n        overview:this.storedata.overview,\r\n      }).then((response) => {this.$store.commit('storedata',response.data.data[0]),this.storeAuth=false});\r\n\r\n      // 画像データをS3に送信してパスをDBにいれる Post\r\n      await axios.post(this.$store.state.host + \"/api/v1/\" + this.$store.state.user.storeAdmin_store_id + \"/storeAdmin/stores/image\",imagedata,config).then((response) => {this.$store.commit('image',response.data.data)})\r\n    },\r\n\r\n    async reservationdatain(){\r\n\r\n      //  予約データの取得 Get\r\n      await axios.get( this.$store.state.host + \"/api/v1/\" + this.$store.state.storedata.id + \"/storeAdmin/reservations\").then((response) => {this.reservationdata =response.data.data})\r\n\r\n      //データの取得が完了したことを確認するためのスイッチ。しかし現状エラー内容になるので一時御遺徳\r\n      this.sync=true\r\n    },\r\n  },\r\n\r\n   created() {\r\n     if(this.$store.state.user.storeAdmin === 1){\r\n        this.reservationdatain();\r\n     }\r\n    \r\n  },\r\n\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n\r\n\r\n\r\n\r\n#StoreAdmin{\r\n  background-color:rgb(206, 206, 206);\r\n  width:100%;\r\n}\r\n\r\n.flex {\r\n  display: flex;\r\n  flex-wrap :wrap;\r\n}\r\n\r\n.header-icon p{\r\n  margin-top:55px;\r\n  margin-left:60px;\r\n  font-size:18px;\r\n  cursor: pointer;\r\n  color:yellow;\r\n}\r\n\r\n.left-storedata{\r\n  display: table;\r\n  width:35%;\r\n  margin:80px auto;\r\n}\r\n\r\n.store-top{\r\n  padding-bottom:15px;\r\n  color:black;\r\n  border-bottom:2px solid black;\r\n}\r\n\r\n.storedata{\r\n  margin:40px 15px;\r\n}\r\n\r\n.data{\r\n  padding-bottom:15px;\r\n}\r\n\r\n.data th{\r\n  color:black;\r\n  width:110px;\r\n  text-align: left;\r\n  vertical-align:top;\r\n}\r\n\r\n\r\n.data label{\r\n  color:black;\r\n  font-size:16px;\r\n}\r\n\r\n.storedatas{\r\n  padding-left:20%;\r\n}\r\n\r\n.data td{\r\n  color:black;\r\n  width:40%;\r\n  text-align: left;\r\n}\r\n\r\n.data form{\r\n  color:black;\r\n  width:40%;\r\n  margin-left:60px;\r\n}\r\n\r\n.data input{\r\n  color:black;\r\n  vertical-align:top;\r\n}\r\n\r\n.data textarea{\r\n  color:black;\r\n  padding:10px 10px;\r\n  vertical-align:top;\r\n}\r\n\r\n.right-reservation{\r\n  width:40%;\r\n  margin:80px 0;\r\n  padding-right:60px;\r\n}\r\n\r\n.reservation-top{\r\n  padding-bottom:15px;\r\n  color:black;\r\n  border-bottom:2px solid black;\r\n}\r\n\r\n.reservationdata{\r\n  margin:40px 15px;\r\n}\r\n\r\n.reservation-store {\r\n  margin-bottom:30px;\r\n}\r\n\r\n\r\nbutton {\r\n  display: table;\r\n  width: 100px;\r\n  text-align: center;\r\n  padding: 8px 0 10px;\r\n  color: #fff;\r\n  background-color: #2f00ff;\r\n  border-radius: 25px;\r\n  cursor: pointer;\r\n  margin:60px auto 0;\r\n}\r\n\r\n</style>"]}]}